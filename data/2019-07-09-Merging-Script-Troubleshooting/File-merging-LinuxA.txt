#March 20 21, 2019

#Example for file merging in linux
#with help from Steven Roberts

#files 

#https://github.com/sr320/nb-2019/blob/master/misc/01-CB_blast-2-slim.ipynb
#blastout.tab
#sp.tab

#wd

#set blastout file as variable
#file includes .tab :)

blastout="blastout.tab"

#check file

head -2 $blastout

#convert pipes to tab
#look at original file tr means translate
tr '|' '\t' < $blastout \
> _blast-sep.tab

#check new table
head -2 _blast-sep.tab

#reducing number of columns and sorting
awk -v OFS='\t' '{print $3, $1, $13}' < _blast-sep.tab | sort \
> _blast-sort.tab

#Sort SPID
head -2 sp.tab

#sorting second column
sort sp.tab -k 2  > uniprot-SP-GO.sorted

#Joining Blast with Uniprot annotation file

join -1 1 -2 2 -t $'\t' \
_blast-sort.tab \
uniprot-SP-GO.sorted \
> _blast-annot.tab

#check file
head -2 _blast-annot.tab

#ok, we're going to try this

Zosterablastout="Zostera_SwissProt_e5_ouput"

head -2 $Zosterablastout

tr '|' '\t' < $Zosterablastout \
> _blastZ-sep.tab

head -2 _blastZ-sep.tab

awk -v OFS='\t' '{print $3, $1, $13}' < _blastZ-sep.tab | sort \
> _blastZ-sort.tab

head goa_uniprot_gcrp.gpa
more goa_uniprot_gcrp.gpa

sort goa_uniprot_gcrp.gpa -k 2  > uniprot-SP-GO.sorted 


join -1 1 -2 2 -t $'\t' \
_blastZ-sort.tab \
uniprot-SP-GO.sorted \
> _blast-annotZ.tab

#yes!!

5_31_2019


sort genes.counts.matrix -k 1 > sorted.genes &
Head sorted.genes
sort Trinity.fasta.gene_trans_map -k 1 > sorted.gene.trans &
Head sorted.gene.trans

join -1 1 -1 1 -t $'\t' \
sorted.gene.trans \
sorted.genes \
> sorted.genes.trans.tab

join -1 1 -1 1 -t $'\t' \
sorted.gene.trans \
sorted_newgenes \
> genes.trans.tab

#puts in duplicates of gene expression
#maybe try joining annotations instead?
Which file?

sort -u -k2,2 genes.trans.tab >unique_genes

#checking how annotations were done
sort Zostera_SwissProt_e5_output -k 1 >sortedNZSP_contig &

And for the non-Zostera

sort nonZostera_SwissProt_e5_output -k 1 >sortedNZSP_contig &

#how many columns, need to delete some

head -1 blastgoprotnZ.tab | tr '|' ' ' | wc -w

30

head -1 _blastnZ-sep.tab | tr '|' ' ' | wc -w

14
#appears to work

#reducing number of columns and sorting
awk -v OFS='\t' '{print $1, $2, $3, $7}' < blastgoprotnZ.tab | sort \
> blastgoprotnZ_short

join -2 2 

/data1/colleenb/eelgrass/annotations/nonZostera_join


Transmap="Trinity.fasta.gene_trans_map"

head $Transmap

tr '|' '\t' < $Transmap \
> _sep_Transmap.tab

sort _sep_Transmap.tab -k 2 > _sort_Transmap.tab

join -2 2 -2 -2 

BlastgoprotnZ="blastgoprotnZ_short"

Head $BlastgoprotnZ

tr '|' '\t' < $BlastgoprotnZ \
> _sep_BlastgoprotnZ.tab

sort _sep_BlastgoprotnZ.tab -k 2 > _sort_BlastgoprotnZ.tab

join -2 2 -2 2 -t $'\t' \
_sort_Transmap.tab \
_sort_BlastgoprotnZ.tab \
> _Transmap_BlastgoprotnZ.tab

#not all genes present=problem?
#also noticed that some instead of being GOREF are PMID in the short file2

head -1 uniprot-SP-GO.sorted | tr '|' ' ' | wc -w

head 




















