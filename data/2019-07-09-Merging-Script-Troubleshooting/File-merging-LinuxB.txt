#March 20 21, 2019

#Example for file merging in linux
#with help from Steven Roberts

#files 

#https://github.com/sr320/nb-2019/blob/master/misc/01-CB_blast-2-slim.ipynb
#blastout.tab
#sp.tab

#wd

#set blastout file as variable
#file includes .tab :)

blastout="blastout.tab"

#check file

head -2 $blastout

#convert pipes to tab
#look at original file tr means translate
tr '|' '\t' < $blastout \
> _blast-sep.tab

#check new table
head -2 _blast-sep.tab

#reducing number of columns and sorting
awk -v OFS='\t' '{print $3, $1, $13}' < _blast-sep.tab | sort \
> _blast-sort.tab

#Sort SPID
head -2 sp.tab

#sorting second column
sort sp.tab -k 2  > uniprot-SP-GO.sorted

#Joining Blast with Uniprot annotation file

join -1 1 -2 2 -t $'\t' \
_blast-sort.tab \
uniprot-SP-GO.sorted \
> _blast-annot.tab

#check file
head -2 _blast-annot.tab

#ok, we're going to try this

Zosterablastout="Zostera_SwissProt_e5_ouput"

head -2 $Zosterablastout

tr '|' '\t' < $Zosterablastout \
> _blastZ-sep.tab

head -2 _blastZ-sep.tab

awk -v OFS='\t' '{print $3, $1, $13}' < _blastZ-sep.tab | sort \
> _blastZ-sort.tab

head goa_uniprot_gcrp.gpa
more goa_uniprot_gcrp.gpa

sort goa_uniprot_gcrp.gpa -k 2  > uniprot-SP-GO.sorted 


join -1 1 -2 2 -t $'\t' \
_blastZ-sort.tab \
uniprot-SP-GO.sorted \
> _blast-annotZ.tab

#yes!!

#May 17, 2019

nonZosterablastout="nonZostera_SwissProt_e5_output"


head -2 $nonZosterablastout


tr '|' '\t' < $nonZosterablastout \

head -2 _blastnZ-sep.tab

awk -v OFS='\t' '{print $3, $1, $13}' < _blastnZ-sep.tab | sort \
> _blastnZ-sort.tab

head -2 _blastnZ-sort.tab
#shows columns, may need to keep others??

head goa_uniprot_gcrp.gpa
more goa_uniprot_gcrp.gpa

q

#remember to put & in next time
sort goa_uniprot_gcrp.gpa -k 2  > uniprot-SP-GO.sorted &

head uniprot-SP-GO.sorted


join -1 1 -2 2 -t $'\t' \
_blastnZ-sort.tab \
uniprot-SP-GO.sorted \
> _blast-annotnZ.tab &

Yes!!

#ok, putting protein names on file, need to first get Uniprot file with protein names from 
https://www.uniprot.org/uniprot/?query=reviewed:yes


tr '|' '\t' < $_blast-annotZ.tab \

head uniprot-reviewed_yes.tab

sort uniprot-reviewed_yes.tab -k 1 > sort_uniprot.tab &

head -2 sort_uniprot.tab

join -1 1 -1 1 -t $'\t' \
_blast-annotZ.tab \
sort_uniprot.tab \
> _blastgoprot.tab &

#what directory am I in?

pwd

#I needed /data1 included in my path to copy

cp uniprot-SP-GO.sorted /data1/colleenb/eelgrass/annotations/nonZostera_join &

cp sort_uniprot.tab /data1/colleenb/eelgrass/annotations/nonZostera_join &

#same with nonZostera

#first check ordering

sort _blast-annotnZ.tab -k 1 >sort_blast-annotnZ.tab &


join -1 1 -1 1 -t $'\t' \
sort_blast-annotnZ.tab \
sort_uniprot.tab \
> blastgoprotnZ.tab &

#too much






















